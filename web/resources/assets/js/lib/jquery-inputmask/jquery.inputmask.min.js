/*
 Input Mask plugin for jquery
 http://github.com/RobinHerbots/jquery.inputmask
 Copyright (c) 2010 - 2012 Robin Herbots
 Licensed under the MIT license (http://www.opensource.org/licenses/mit-license.php)
 Version: 1.2.2
*/
(function(g){void 0==g.fn.inputmask&&(g.inputmask={defaults:{placeholder:"_",optionalmarker:{start:"[",end:"]"},escapeChar:"\\",mask:null,oncomplete:g.noop,onincomplete:g.noop,oncleared:g.noop,repeat:0,greedy:!0,autoUnmask:!1,clearMaskOnLostFocus:!0,insertMode:!0,clearIncomplete:!1,aliases:{},onKeyUp:g.noop,onKeyDown:g.noop,showMaskOnHover:!0,numericInput:!1,radixPoint:".",definitions:{9:{validator:"[0-9]",cardinality:1},a:{validator:"[A-Za-z\u0410-\u044f\u0401\u0451]",cardinality:1},"*":{validator:"[A-Za-z\u0410-\u044f\u0401\u04510-9]",
cardinality:1}},keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91},ignorables:[8,9,13,16,17,18,20,27,33,34,35,36,37,38,39,40,46,91,93,108]},val:g.fn.val},g.fn.inputmask=function(F,
V){function H(a){return(a=b.aliases[a])?(a.alias&&H(a.alias),g.extend(!0,b,a),g.extend(!0,b,V),!0):!1}function K(){var a=!1,c=0;1==b.mask.length&&!1==b.greedy&&(b.placeholder="");for(var f=g.map(b.mask.split(""),function(f){var q=[];if(f==b.escapeChar)a=!0;else if(f!=b.optionalmarker.start&&f!=b.optionalmarker.end||a){var g=b.definitions[f];if(g&&!a)for(f=0;f<g.cardinality;f++)q.push(B(c+f));else q.push(f),a=!1;c+=q.length;return q}}),q=f.slice(),d=1;d<b.repeat&&b.greedy;d++)q=q.concat(f.slice());
return q}function N(){var a=!1,c=!1,f=!1;return g.map(b.mask.split(""),function(q){var g=[];if(q==b.escapeChar)c=!0;else if(q==b.optionalmarker.start&&!c)f=a=!0;else if(q==b.optionalmarker.end&&!c)a=!1,f=!0;else{var d=b.definitions[q];if(d&&!c){for(var j=d.prevalidator,h=j?j.length:0,i=1;i<d.cardinality;i++){var p=h>=i?j[i-1]:[],e=p.validator,p=p.cardinality;g.push({fn:e?"string"==typeof e?RegExp(e):new function(){this.test=e}:/./,cardinality:p?p:1,optionality:a,newBlockMarker:!0==a?f:!1,offset:0,
casing:d.casing,def:q});!0==a&&(f=!1)}g.push({fn:d.validator?"string"==typeof d.validator?RegExp(d.validator):new function(){this.test=d.validator}:/./,cardinality:d.cardinality,optionality:a,newBlockMarker:f,offset:0,casing:d.casing,def:q})}else g.push({fn:null,cardinality:0,optionality:a,newBlockMarker:f,offset:0,casing:null,def:q}),c=!1;f=!1;return g}})}function I(a,c,f,g){if(0>a||a>=p())return!1;for(var d=a%j.length,m=c?1:0,t="",h=j[d].cardinality;h>m;h--)t+=u(f,d-(h-1));c&&(t+=c);return null!=
j[d].fn?j[d].fn.test(t,f,a,g,b):!1}function v(a){a=j[a%j.length];return void 0!=a?a.fn:!1}function B(a){return b.placeholder.charAt(a%b.placeholder.length)}function p(){var a=d.length;!b.greedy&&1<b.repeat&&(a+=d.length*(b.repeat-1));return a}function y(a,b){var f=p();if(b>=f)return f;for(var g=b;++g<f&&!v(g););return g}function C(a,b){var f=b;if(0>=f)return 0;for(;0<--f&&!v(f););return f}function G(a,b,f){var g=j[b%j.length],d=f;if(void 0!=d)switch(g.casing){case "upper":d=f.toUpperCase();break;
case "lower":d=f.toLowerCase()}a[b]=d}function u(a,b,f){f&&(b=P(a,b));return a[b]}function P(a,b,f){if(f)for(;0>b&&a.length<p();){f=d.length-1;for(b=d.length;void 0!==d[f];)a.unshift(d[f--])}else for(;void 0==a[b]&&a.length<p();)for(f=0;void 0!==d[f];)a.push(d[f++]);return b}function A(a,b,f){a._valueSet(b.join(""));void 0!=f&&(L?setTimeout(function(){m(a,f)},100):m(a,f))}function Q(b,c,f){for(var g=p();c<f&&c<g;c++)G(b,c,u(d.slice(),c))}function M(b,c){G(b,c,u(d,c%j.length))}function r(a,c,f,q){var m=
g(a).data("inputmask").isRTL,r=O(a._valueGet(),m).split("");if(m){var t=p(),h=r.reverse();h.length=t;for(var i=0;i<t;i++){var x=(t-(i+1))%j.length;null==j[x].fn&&h[i]!=u(d,x)?(h.splice(i,0,u(d,x)),h.length=t):h[i]=h[i]||u(d,x)}r=h.reverse()}Q(c,0,c.length);c.length=d.length;for(var e=h=-1,D,t=p(),C=r.length,x=0==C?t:-1,i=0;i<C;i++)for(var s=e+1;s<t;s++)if(v(s)){var w=r[i];!1!==(D=I(s,w,c,!f))?(!0!==D&&(s=D.pos||s,w=D.c||w),G(c,s,w),h=e=s):(M(c,s),w==B(s)&&(x=e=s));break}else if(M(c,s),h==e&&(h=s),
e=s,r[i]==u(c,s))break;if(!1==b.greedy)for(i=O(c.join(""),m).split("");c.length!=i.length;)m?c.shift():c.pop();f&&A(a,c);return m?b.numericInput?-1!=g.inArray(b.radixPoint,c)&&!0!==q?g.inArray(b.radixPoint,c):y(c,t):y(c,x):y(c,h)}function W(b){return b.replace(RegExp("(\\/|\\.|\\*|\\+|\\?|\\||\\(|\\)|\\[|\\]|\\{|\\}|\\\\)","gim"),"\\$1")}function O(b,c){return c?b.replace(RegExp("^("+W(d.join(""))+")*"),""):b.replace(RegExp("("+W(d.join(""))+")*$"),"")}function R(b,c){r(b,c,!1);var f=c.slice();if(g(b).data("inputmask").isRTL)for(var d=
0;d<=f.length-1;d++){var m=d%j.length;if(j[m].optionality)if(B(d)==c[d]||!v(d))f.splice(0,1);else break;else break}else for(d=f.length-1;0<=d;d--)if(m=d%j.length,j[m].optionality)if(B(d)==c[d]||!v(d))f.pop();else break;else break;A(b,f)}function X(b,c){var f=b[0];if(j&&(!0===c||!b.hasClass("hasDatepicker"))){var q=d.slice();r(f,q);return g.map(q,function(b,a){return v(a)&&b!=u(d.slice(),a)?b:null}).join("")}return f._valueGet()}function m(a,c,f){a=a.jquery&&0<a.length?a[0]:a;if("number"==typeof c){f=
"number"==typeof f?f:c;!1==b.insertMode&&c==f&&f++;if(a.setSelectionRange)a.setSelectionRange(c,f);else if(a.createTextRange){var d=a.createTextRange();d.collapse(!0);d.moveEnd("character",f);d.moveStart("character",c);d.select()}a.focus()}else{var g=L?d:null,d=null;null==g&&(a.setSelectionRange?(c=a.selectionStart,f=a.selectionEnd):document.selection&&document.selection.createRange&&(d=document.selection.createRange(),c=0-d.duplicate().moveStart("character",-1E5),f=c+d.text.length),g={begin:c,end:f});
return g}}function S(a){function c(b){for(var a=!0,b=b._valueGet(),e=b.length,d=0;d<e;d++)if(v(d)&&b.charAt(d)==B(d)){a=!1;break}return a}function f(b,a,f){for(;!v(b)&&0<=b-1;)b--;for(var c=b;c<a&&c<p();c++)if(v(c)){M(e,c);var g=y(e,c),h=u(e,g);if(h!=B(g))if(g<p()&&!1!==I(c,h,e,!0)&&j[c%j.length].def==j[g%j.length].def)G(e,c,u(e,g)),M(e,g);else{if(v(c))break}else if(void 0==f)break}else M(e,c);void 0!=f&&G(e,z?a:C(e,a),f);e=O(e.join(""),z).split("");0==e.length&&(e=d.slice());return b}function q(b,
a,c,f){for(;b<=a&&b<p();b++)if(v(b)){var g=u(e,b);G(e,b,c);if(g!=B(b))if(c=y(e,b),c<p())if(!1!==I(c,g,e,!0)&&j[b%j.length].def==j[c%j.length].def)c=g;else if(v(c))break;else c=g;else break;else if(!0!==f)break}else M(e,b);f=e.length;e=O(e.join(""),z).split("");0==e.length&&(e=d.slice());return a-(f-e.length)}function E(a){H=!1;var c=this,n=a.keyCode,k=m(c);if(b.numericInput){var l=c._valueGet().indexOf(b.radixPoint);-1!=l&&(z=k.begin<=l||k.end<=l)}if(n==b.keyCode.BACKSPACE||n==b.keyCode.DELETE||Y&&
127==n){l=p();if(0==k.begin&&k.end==l)e=d.slice(),A(c,e),m(c,r(c,e,!1));else if(1<k.end-k.begin||1==k.end-k.begin&&b.insertMode)Q(e,k.begin,k.end),A(c,e,z?r(c,e,!1):k.begin);else{var h=k.begin-(n==b.keyCode.DELETE?0:1);h<J&&n==b.keyCode.DELETE&&(h=J);h>=J&&(b.numericInput&&(b.greedy&&n==b.keyCode.DELETE&&e[h]==b.radixPoint)&&(h=y(e,h),z=!1),z?(h=q(J,h,B(h),!0),h=b.numericInput&&b.greedy&&n==b.keyCode.BACKSPACE&&e[h+1]==b.radixPoint?h+1:y(e,h)):h=f(h,l),A(c,e,h))}c._valueGet()==d.join("")&&g(c).trigger("cleared");
return!1}if(n==b.keyCode.END||n==b.keyCode.PAGE_DOWN)return setTimeout(function(){var d=r(c,e,!1,!0);!b.insertMode&&(d==p()&&!a.shiftKey)&&d--;m(c,a.shiftKey?k.begin:d,d)},0),!1;if(n==b.keyCode.HOME||n==b.keyCode.PAGE_UP)return m(c,0,a.shiftKey?k.begin:0),!1;if(n==b.keyCode.ESCAPE)return c._valueSet(D),m(c,0,r(c,e)),!1;if(n==b.keyCode.INSERT)return b.insertMode=!b.insertMode,m(c,!b.insertMode&&k.begin==p()?k.begin-1:k.begin),!1;if(a.ctrlKey&&88==n)setTimeout(function(){m(c,r(c,e,!0))},0);else if(!b.insertMode){if(n==
b.keyCode.RIGHT)return n=k.begin==k.end?k.end+1:k.end,n=n<p()?n:k.end,m(c,a.shiftKey?k.begin:n,a.shiftKey?n+1:n),!1;if(n==b.keyCode.LEFT)return n=k.begin-1,n=0<n?n:0,m(c,n,a.shiftKey?k.end:n),!1}b.onKeyDown.call(this,a,b);s=-1!=g.inArray(n,b.ignorables)}function F(a){if(H)return!1;H=!0;var d=this,h=g(d),a=a||window.event,k=a.which||a.charCode||a.keyCode;if(b.numericInput&&k==b.radixPoint.charCodeAt(b.radixPoint.length-1)){var l=d._valueGet().indexOf(b.radixPoint);m(d,y(e,-1!=l?l:p()))}if(a.ctrlKey||
a.altKey||a.metaKey||s)return!0;if(k){h.trigger("input");var a=m(d),k=String.fromCharCode(k),j=p();Q(e,a.begin,a.end);if(z){var l=b.numericInput?a.end:C(e,a.end),i;if(!1!==(i=I(l==j||u(e,l)==b.radixPoint?C(e,l):l,k,e,!1))){!0!==i&&(l=i.pos||a,k=i.c||k);i=J;if(!0==b.insertMode){if(!0==b.greedy)for(var r=e.slice();u(r,i,!0)!=B(i)&&i<=l;)i=i==j?j+1:y(e,i);if(i<=l&&(b.greedy||e.length<j))e[J]!=B(J)&&e.length<j&&(j=P(e,-1,z),0!=a.end&&(l+=j),j=e.length),f(i,b.numericInput?C(e,l):l,k);else return!1}else G(e,
b.numericInput?C(e,l):l,k);A(d,e,b.numericInput&&0==l?y(e,l):l);setTimeout(function(){c(d)&&h.trigger("complete")},0)}else L&&A(d,e,a.begin)}else if(l=y(e,a.begin-1),P(e,l,z),!1!==(i=I(l,k,e,!1))){!0!==i&&(l=i.pos||l,k=i.c||k);if(!0==b.insertMode){a=p();for(r=e.slice();u(r,a,!0)!=B(a)&&a>=l;)a=0==a?-1:C(e,a);if(a>=l)q(l,e.length,k);else return!1}else G(e,l,k);a=y(e,l);A(d,e,a);setTimeout(function(){c(d)&&h.trigger("complete")},0)}else L&&A(d,e,a.begin);return!1}}function t(a){var c=g(this),f=a.keyCode;
b.onKeyUp.call(this,a,b);f==b.keyCode.TAB&&(c.hasClass("focus.inputmask")&&0==this._valueGet().length)&&(e=d.slice(),A(this,e),z||m(this,0),D=this._valueGet())}var h=g(a);if(h.is(":input")){b.greedy=b.greedy?b.greedy:0==b.repeat;var i=h.prop("maxLength");p()>i&&-1<i&&(i<d.length&&(d.length=i),!1==b.greedy&&(b.repeat=Math.round(i/d.length)));h.prop("maxLength",2*p());h.data("inputmask",{tests:j,_buffer:d,greedy:b.greedy,repeat:b.repeat,autoUnmask:b.autoUnmask,definitions:b.definitions,isRTL:!1});var x;
Object.getOwnPropertyDescriptor&&(x=Object.getOwnPropertyDescriptor(a,"value"));x&&x.get?a._valueGet||(a._valueGet=x.get,a._valueSet=x.set,Object.defineProperty(a,"value",{get:function(){var b=g(this),a=g(this).data("inputmask");return a&&a.autoUnmask?b.inputmask("unmaskedvalue"):this._valueGet()!=a._buffer.join("")?this._valueGet():""},set:function(a){this._valueSet(a);g(this).triggerHandler("setvalue.inputmask")}})):document.__lookupGetter__&&a.__lookupGetter__("value")?a._valueGet||(a._valueGet=
a.__lookupGetter__("value"),a._valueSet=a.__lookupSetter__("value"),a.__defineGetter__("value",function(){var a=g(this),b=g(this).data("inputmask");return b&&b.autoUnmask?a.inputmask("unmaskedvalue"):this._valueGet()!=b._buffer.join("")?this._valueGet():""}),a.__defineSetter__("value",function(a){this._valueSet(a);g(this).triggerHandler("setvalue.inputmask")})):(a._valueGet||(a._valueGet=function(){return this.value},a._valueSet=function(a){this.value=a}),!0!=g.fn.val.inputmaskpatch&&(g.fn.val=function(){if(0==
arguments.length){var a=g(this);if(a.data("inputmask")){if(a.data("inputmask").autoUnmask)return a.inputmask("unmaskedvalue");var b=g.inputmask.val.apply(a);return b!=a.data("inputmask")._buffer.join("")?b:""}return g.inputmask.val.apply(a)}var c=arguments;return this.each(function(){var a=g(this),b=g.inputmask.val.apply(a,c);a.data("inputmask")&&a.triggerHandler("setvalue.inputmask");return b})},g.extend(g.fn.val,{inputmaskpatch:!0})));var e=d.slice(),D=a._valueGet(),H=!1,s=!1,w=-1,J=y(e,-1);C(e,
p());var z=!1;if("rtl"==a.dir||b.numericInput)a.dir="ltr",h.css("text-align","right"),h.removeAttr("dir"),i=h.data("inputmask"),i.isRTL=!0,h.data("inputmask",i),z=!0;h.unbind(".inputmask");h.removeClass("focus.inputmask");h.bind("mouseenter.inputmask",function(){if(!g(this).hasClass("focus.inputmask")&&b.showMaskOnHover){var a=this._valueGet().length;a<e.length&&(0==a&&(e=d.slice()),A(this,e))}}).bind("blur.inputmask",function(){var a=g(this),f=this._valueGet();a.removeClass("focus.inputmask");f!=
D&&a.change();b.clearMaskOnLostFocus&&(f==d.join("")?this._valueSet(""):R(this,e));c(this)||(a.trigger("incomplete"),b.clearIncomplete&&(b.clearMaskOnLostFocus?this._valueSet(""):(e=d.slice(),A(this,e))))}).bind("focus.inputmask",function(){var a=g(this);if(!a.hasClass("focus.inputmask")&&!b.showMaskOnHover){var c=this._valueGet().length;c<e.length&&(0==c&&(e=d.slice()),m(this,r(this,e,!0)))}a.addClass("focus.inputmask");D=this._valueGet()}).bind("mouseleave.inputmask",function(){var a=g(this);b.clearMaskOnLostFocus&&
(a.hasClass("focus.inputmask")||(this._valueGet()==d.join("")||""==this._valueGet()?this._valueSet(""):R(this,e)))}).bind("click.inputmask",function(){var a=this;setTimeout(function(){var b=m(a);b.begin==b.end&&(b=b.begin,w=r(a,e,!1),z?m(a,b>w&&(!1!==I(b,e[b],e,!0)||!v(b))?b:w):m(a,b<w&&(!1!==I(b,e[b],e,!0)||!v(b))?b:w))},0)}).bind("dblclick.inputmask",function(){var a=this;setTimeout(function(){m(a,0,w)},0)}).bind("keydown.inputmask",E).bind("keypress.inputmask",F).bind("keyup.inputmask",t).bind(Z+
".inputmask, dragdrop.inputmask, drop.inputmask",function(){var a=this;setTimeout(function(){m(a,r(a,e,!0))},0)}).bind("setvalue.inputmask",function(){D=this._valueGet();r(this,e,!0);this._valueGet()==d.join("")&&this._valueSet("")}).bind("complete.inputmask",b.oncomplete).bind("incomplete.inputmask",b.onincomplete).bind("cleared.inputmask",b.oncleared);var w=r(a,e,!0),K;try{K=document.activeElement}catch(N){}K===a?(h.addClass("focus.inputmask"),m(a,w)):b.clearMaskOnLostFocus&&(a._valueGet()==d.join("")?
a._valueSet(""):R(a,e));h=g._data(a).events;g.each(h,function(b,c){g(a).bind(b+".inputmask",function(a){if(this.readOnly||this.disabled)return a.stopPropagation(),a.stopImmediatePropagation(),a.preventDefault(),!1});for(var d=c[c.length-1],e=c.length-1;0<e;e--)c[e]=c[e-1];c[0]=d})}}var b=g.extend(!0,{},g.inputmask.defaults,V),E="paste",T=document.createElement("input"),E="on"+E,U=E in T;U||(T.setAttribute(E,"return;"),U="function"==typeof T[E]);var Z=U?"paste":"input",Y=null!=navigator.userAgent.match(/iphone/i),
L=null!=navigator.userAgent.match(/android.*mobile safari.*/i);L&&(E=navigator.userAgent.match(/mobile safari.*/i),L=533>=parseInt(RegExp(/[0-9]+/).exec(E)));if("string"==typeof F)switch(F){case "mask":var d=K(),j=N();return this.each(function(){S(this)});case "unmaskedvalue":return j=this.data("inputmask").tests,d=this.data("inputmask")._buffer,b.greedy=this.data("inputmask").greedy,b.repeat=this.data("inputmask").repeat,b.definitions=this.data("inputmask").definitions,X(this);case "remove":return this.each(function(){var a=
g(this),c=this;setTimeout(function(){if(a.data("inputmask")){j=a.data("inputmask").tests;d=a.data("inputmask")._buffer;b.greedy=a.data("inputmask").greedy;b.repeat=a.data("inputmask").repeat;b.definitions=a.data("inputmask").definitions;c._valueSet(X(a,!0));a.removeData("inputmask");a.unbind(".inputmask");a.removeClass("focus.inputmask");var f;Object.getOwnPropertyDescriptor&&(f=Object.getOwnPropertyDescriptor(c,"value"));f&&f.get?c._valueGet&&Object.defineProperty(c,"value",{get:c._valueGet,set:c._valueSet}):
document.__lookupGetter__&&c.__lookupGetter__("value")&&c._valueGet&&(c.__defineGetter__("value",c._valueGet),c.__defineSetter__("value",c._valueSet));delete c._valueGet;delete c._valueSet}},0)});case "getemptymask":return this.data("inputmask")?this.data("inputmask")._buffer.join(""):"";case "hasMaskedValue":return this.data("inputmask")?!this.data("inputmask").autoUnmask:!1;default:return H(F)||(b.mask=F),d=K(),j=N(),this.each(function(){S(this)})}if("object"==typeof F)return b=g.extend(!0,{},g.inputmask.defaults,
F),H(b.alias),d=K(),j=N(),this.each(function(){S(this)})})})(jQuery);